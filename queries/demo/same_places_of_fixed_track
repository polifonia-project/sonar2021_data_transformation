PREFIX core:  <https://w3id.org/polifonia/ON/core/>
PREFIX pr:    <https://w3id.org/polifonia/resource/>
PREFIX mp:    <https://w3id.org/polifonia/ON/musical-performance/>
PREFIX rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX mc:    <https://w3id.org/polifonia/ON/musical-composition/>
PREFIX mf:    <https://w3id.org/polifonia/ON/musical-feature/>
PREFIX cm:    <https://w3id.org/polifonia/ON/comparative-measure/>
PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>

SELECT DISTINCT
?song1, ?song2, ?label_place_art1, ?label_place_rec1, ?label2, ?label_place_art2, ?label_place_rec2, ?artist_label2
WHERE {
    ?song1 core:hasTitle ?t1 ;
                mp:hasRecordingPerformer ?artist1 .
    ?t1 rdfs:label "Der Lindenbaum" .

    {?artist1 ?rel_place1 ?place_art1 . ?place_art1 rdfs:label ?label_place_art1}
    UNION
    {?song1 mp:isRecordingProducedBy ?rp1 .
     ?rp1 mp:hasSession ?session1 .
     ?session1 core:hasPlace ?place_rec1 . ?place_rec1 rdfs:label ?label_place_rec1}

    ?place_rec1 a core:PhysicalSite .
    {?place_art1 a core:Place}
    UNION
    {?place_art1 a core:Country}

   ?song2 core:hasTitle ?t2 ;
                mp:hasRecordingPerformer ?artist2.
    ?t2 rdfs:label ?label2 .
    ?artist2 rdfs:label ?artist_label2 .

    {?artist2 ?rel_place2 ?place_art2 . ?place_art2 rdfs:label ?label_place_art2}
    UNION
    {?song2 mp:isRecordingProducedBy ?rp2 .
     ?rp2 mp:hasSession ?session2 .
     ?session2 core:hasPlace ?place_rec2 . ?place_rec2 rdfs:label ?label_place_rec2}

    ?place_rec2 a core:PhysicalSite .
    {?place_art2 a core:Place}
    UNION
    {?place_art2 a core:Country}
FILTER((?label_place_art1 = ?label_place_art2) || (?label_place_rec1 = ?label_place_rec2) || (?label_place_art1 = ?label_place_rec2) || (?label_place_rec1 = ?label_place_art2))
FILTER((?artist1 != ?artist2) && (?label2 = "Der Lindenbaum"))
}
